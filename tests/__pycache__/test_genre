from src.commun import get_genre
import json
from datetime import datetime, date

#create a test of the get_movie_genre function
def test_input():
   
    result = get_genre()

    #Assert that the result is not empty
    assert result is not None

    # Parse JSON string
    data = json.loads(result)

    # Check if each release date is a valid date
    for movie in data:
        release_date_str = movie.get('release_date')
        #Assert that the release dates are of type date
        release_date = datetime.strptime(release_date_str, "%Y-%m-%d").date()
        assert isinstance(release_date, date) 

    # Check if each genre is a string
    for movie in data:
        genre = movie.get('genre')
        assert isinstance(genre, list)
        for g in genre:
            assert isinstance(g, str)
    
    # Check if there is 3 keys in the dictionary
    for movie in data:
        assert len(movie) == 3
        assert 'name' in movie
        assert 'release_date' in movie
        assert 'genre' in movie
        